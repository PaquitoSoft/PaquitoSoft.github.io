<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Ractive.js tutorial - Managing user&#x27;s notes (5 of 6)</title><meta name="date" content="2015-08-02T11:03:31.081Z"/><meta name="keywords" content="tutorial, javascript, ractive, ractivejs"/><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/fca08b764e01d142.css" as="style"/><link rel="stylesheet" href="/_next/static/css/fca08b764e01d142.css" data-n-g=""/><link rel="preload" href="/_next/static/css/4727cb7922ba92a1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4727cb7922ba92a1.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-f6f8e789435065da.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-59f1ed9830ced99b.js" defer=""></script><script src="/_next/static/chunks/pages/_app-12e47b2d3cbfdb5e.js" defer=""></script><script src="/_next/static/chunks/834-1fce47b417d9f245.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-86b3e650bf853aa5.js" defer=""></script><script src="/_next/static/Dhh1eIxwrKki7CqZexiwV/_buildManifest.js" defer=""></script><script src="/_next/static/Dhh1eIxwrKki7CqZexiwV/_ssgManifest.js" defer=""></script><script src="/_next/static/Dhh1eIxwrKki7CqZexiwV/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><header class="header_header__U_Kza"><a class="title-link_titleLink__5zxWi header_title__DvyTk" href="/"><h2>Paquitosoft&#x27;s corner</h2></a></header><main class="container main-content"><div class="grid"><section><div><article class="card_card__43_8m"><header class="card_title__ITk4U"><h3>Ractive.js tutorial - Managing user&#x27;s notes (5 of 6)</h3></header><div><span><p>(<em>Previous step: <a href="/post/ractive-js-tutorial-loading-user-info">Loading user info</a></em>)</p>
<p>Now we want to add to our little application the ability to create and delete notes for the users we can already see.
We will have a collection of notes for every user.</p>
<p>We need somewhere to store that notes and, for this tutorial, we'll use <a href="https://www.firebase.com/">Firebase</a> free plan service.
If you don't have an account, go and create one. Once you have it, create a new APP from your account page.
Now that you have your APP created, take note of its URL, as we'll be using it to integrate our application using <a href="https://www.firebase.com/docs/rest/quickstart.html">Firebase REST API</a>.
The URL should be something like this: https://ps-github-saver.firebaseio.com/.</p>
<p>First of all, we're going to populate our notes component, as right now it's empty.
We could just put all the code in the <em>notes-section</em> component, but for the sake of modularity (it would also help with the testing), we will have another two components:</p>
<ul>
<li>add-note: a little component to handle notes creation.</li>
<li>notes-list: a little component to show current notes and allow removing them.</li>
</ul>
<p>Let's go for the sub-components:
<strong><em>root-folder</em>/app/views/user/add-note.html</strong></p>
<pre><code class="language-html">&lt;form on-submit=&quot;createNote&quot;&gt;
	&lt;div class=&quot;input-group&quot;&gt;
		&lt;input type=&quot;text&quot; class=&quot;form-control&quot; value=&quot;{{newNote}}&quot; placeholder=&quot;Add new note...&quot; /&gt;
		&lt;span class=&quot;input-group-btn&quot;&gt;
			&lt;button class=&quot;btn btn-default&quot; type=&quot;submit&quot;&gt; Add &lt;/button&gt;
		&lt;/span&gt;
	&lt;/div&gt;
&lt;/form&gt;
</code></pre>
<p><strong><em>root-folder</em>/app/js/components/user/notes/add-note.js</strong></p>
<pre><code class="language-javascript">import Ractive from 'ractive';
import User from '../../../models/user';
import Template from '../../../../views/user/notes/add-note.html';

var AddNote = Ractive.extend({
	isolated: true,
	template: Template,
	oninit: function() {
		this.on('createNote', (rEvent) =&gt; {
			rEvent.original.preventDefault();
			this.fire('AddUserNote', rEvent.context.newNote);
			this.set('newNote', '');
		});
	},
	data: {
		newNote: ''
	}
});

export default AddNote;
</code></pre>
<p>This component just shows an input with a button so we can type our note and proceed saving it.
The <strong>createNote</strong> proxy event just fires a custom event with the introduced note message.
This event will bubble up through all parent components so any of them (the right one) can handle it.</p>
<p>Now, the <em>notes-list</em> component.
<strong><em>root-folder</em>/app/views/user/notes/notes-list.html</strong></p>
<pre><code class="language-html">&lt;ul class=&quot;list-group&quot;&gt;
	{{#each notes}}
		&lt;li class=&quot;list-group-item&quot;&gt;
			&lt;span&gt;{{.}}&lt;/span&gt;
			&lt;span class=&quot;pull-right&quot;&gt;
				&lt;span class=&quot;glyphicon glyphicon-remove&quot; on-click=&quot;deleteNote&quot; style=&quot;cursor: pointer;&quot;&gt;&lt;/span&gt;
			&lt;/span&gt;
		&lt;/li&gt;
	{{/each}}
&lt;/ul&gt;
</code></pre>
<p><strong><em>root-folder</em>/app/js/components/user/notes/notes-list.js</strong></p>
<pre><code class="language-javascript">import Ractive from 'ractive';
import Template from '../../../views/user/notes/notes-list.html';

var NotesList = Ractive.extend({
	isolated: true,
	template: Template,
	oninit() {
		this.on('deleteNote', (rEvent) =&gt; {
				this.fire('RemoveUserNote', rEvent.context);
		});
	}
});

export default NotesList;
</code></pre>
<p>In the <strong>deleteNote</strong> proxy event, we just fire a custom event with the message we want to delete.</p>
<p>Now we need to update our <em>notes-section</em> component so it uses those new sub-components:
<strong><em>root-folder</em>/app/views/user/notes-section.html</strong></p>
<pre><code class="language-html">&lt;div&gt;
	&lt;h3&gt; Notes &lt;/h3&gt;
	&lt;AddNote /&gt;
	&lt;br/&gt;
	&lt;NotesList notes=&quot;{{notes}}&quot; /&gt;
&lt;/div&gt;
</code></pre>
<p>Note that we pass the notes list from the parent component to the <em>notes-list</em> subcomponent.</p>
<p><strong><em>root-folder</em>/app/js/components/user/notes-section.js</strong></p>
<pre><code class="language-javascript">'use strict';

import Ractive from 'ractive';
import AddNote from './notes/add-note';
import NotesList from './notes/notes-list';
import template from '../../views/user/notes-section.html';

var NotesSection = Ractive.extend({
	isolated: true,
	template: template,
	components: {
		AddNote: AddNote,
		NotesList: NotesList
	}
});

export default NotesSection;
</code></pre>
<p>We just need to update our user page view to pass the notes collection to this section:
<strong><em>root-folder</em>/app/views/user-page.html</strong></p>
<pre><code class="language-html">&lt;div class=&quot;row&quot;&gt;
	&lt;div class=&quot;col-md-4&quot;&gt;
		&lt;UserProfile profile=&quot;{{user.profile}}&quot; /&gt;
	&lt;/div&gt;
	&lt;div class=&quot;col-md-4&quot;&gt;
		&lt;Repos repos=&quot;{{user.repos}}&quot; /&gt;
	&lt;/div&gt;
	&lt;div class=&quot;col-md-4&quot;&gt;
		&lt;Notes notes=&quot;{{user.notes}}&quot; /&gt;
	&lt;/div&gt;
&lt;/div&gt;
</code></pre>
<p>We have all the notes stuff set up, but it's not functional yet as no one is managing reading and saving data to <em>Firebase</em>.
I think reading should be done in the <strong>findByUsername</strong> function from the user model object, so when the user page gets loaded, we have all its needed information.
On the other hand, creating and removing notes should be done from the user page component through the user model object. The user page component is the component who knows which user we're diplaying, so it will be the one listening to sub-component custom events.</p>
<p>Let's begin by reading user's notes.
<strong><em>root-folder</em>/app/js/models/user.js</strong></p>
<pre><code class="language-javascript">import * as ajax from '../plugins/ajax';

const GITHUB_BASE_URL = 'https://api.github.com';
const FIREBASE_BASE_URL = `https://ps-github-saver.firebaseio.com`;

class User {
	
	constructor(profile, repos, notes) {
		this.profile = profile;
		this.repos = repos;
		this.notes = notes || []; // Default parameters values are only valid for undefined ones
	}

	static findByName(username) {
		let userProfileUrl = `${GITHUB_BASE_URL}/users/${username}`,
			userReposUrl = `${GITHUB_BASE_URL}/users/${username}/repos`,
			userNotesUrl = `${FIREBASE_BASE_URL}/${username.toLowerCase()}.json`;

		let result = new Promise((resolve, reject) =&gt; {
			Promise.all([
				ajax.getJson(userProfileUrl),
				ajax.getJson(userReposUrl),
				ajax.getJson(userNotesUrl)
			])
			.then(values =&gt; {
					resolve(new User(values[0], values[1], values[2]));
			})
			.catch(reject);
		});

		return result;
	}
}

export default User;
</code></pre>
<p>We just need to declare the URL for the user's notes in our Firebase project and add another <em>getJson</em> promise to our group.</p>
<p>Now we handle notes creation (in our user page component) so we can see anything in the notes list.
<strong><em>root-folder</em>/app/js/components/user-page.js</strong>:</p>
<pre><code class="language-javascript">import Ractive from 'ractive';
import Template from '../../views/user-page.html';
import UserProfile from './user/profile-section';
import Repos from './user/repos-section';
import Notes from './user/notes-section';

var UserPage = Ractive.components.UserPage = Ractive.extend({
	template: Template,
	components: {
		UserProfile: UserProfile,
		Repos: Repos,
		Notes: Notes
	},
	oninit() {
		this.observe('req', (request) =&gt; {
			this.set('user', request.body.user);
		});

		// *.*, *.AddUserNote, AddNote.*, AddNote.AddUserNote
		this.on('*.AddUserNote', (newNote) =&gt; {
			console.log('UserPage::createNote# Adding new note to user:', this.get('user').profile.login);
			this.get('user').addNote(newNote);
		});
	}
});
UserPage._name = 'UserPage';

export default UserPage;
</code></pre>
<p>The custom events fired from components get their names namespaced. The final event name is built beginning with the name of the component where it was generated, followed by a dot and the name you used when firing the event.
When you register to events, you have the chance to use a wildcard both for the name of the component as well as the name of the event (see the comment above the event handler).</p>
<p>We now need to implement the <strong>addNote</strong> function in the user model.
<strong><em>root-folder</em>/app/js/models/user.js</strong></p>
<pre><code class="language-javascript">import * as ajax from '../plugins/ajax';

const GITHUB_BASE_URL = 'https://api.github.com';
const FIREBASE_BASE_URL = `https://ps-github-saver.firebaseio.com`;

class User {
	
	constructor(profile, repos, notes) {
		this.profile = profile;
		this.repos = repos;
		this.notes = notes || []; // Default parameters values are only valid for undefined ones
	}

	addNote(newNote) {
		this.notes.push(newNote);
		return ajax.putJson(`${FIREBASE_BASE_URL}/${this.profile.login.toLowerCase()}.json`, this.notes);
	}

	static findByName(username) {
		let userProfileUrl = `${GITHUB_BASE_URL}/users/${username}`,
			userReposUrl = `${GITHUB_BASE_URL}/users/${username}/repos`,
			userNotesUrl = `${FIREBASE_BASE_URL}/${username.toLowerCase()}.json`;

		let result = new Promise((resolve, reject) =&gt; {
			Promise.all([
				ajax.getJson(userProfileUrl),
				ajax.getJson(userReposUrl),
				ajax.getJson(userNotesUrl)
			])
			.then(values =&gt; {
				resolve(new User(values[0], values[1], values[2]));
			})
			.catch(reject);
		});

		return result;
	}
}

export default User;
</code></pre>
<p>Here we're adding the new notes to the users note's list so it get updated inmediatly and Ractive will update the view to reflect this change before the note is actually persisted.
Then, we call a new ajax pluging's function (<em>putJson</em>) to save the note in Firebase.</p>
<p>Most of the time, save operation will work, so I prefer to not wait for the back-end response so the user feels our application is blazing fast.
In real world applications we would (for example) implement a mechanism so, if the operation fails, we warn the user and we undo the operation.</p>
<p>Let's add the <strong>putJson</strong> function to our ajax component:
<strong><em>root-folder</em>/app/js/plugins/ajax.js</strong></p>
<pre><code class="language-javascript">function checkResponseStatus(res) {
	if (res.status &lt; 400) {
		return res;
	} else {
		let error = new Error(res.statusText);
		error.statusCode = res.status;
		error.response = res;
		throw error;
	}
}

function parseJson(res) {
	return res.json();
}

export function getJson(url, options = {cache: false}) {
	return fetch(url)
		.then(checkResponseStatus)
		.then(parseJson);
}

export function putJson(url, data) {
	return fetch(url, {
		method: 'put',
		headers: {
			'Accept': 'application/json',
			'Content-Type': 'application/json'
		},
		body: JSON.stringify(data)
	})
	.then(checkResponseStatus);
}
</code></pre>
<p>If you reload the application in your browser right now, you should be able to save notes.</p>
<p>The last step is to add notes removing functionality.
We will follow the same pattern: fire a custom event from the sub-component (<em>notes-list</em>) and handle it from the user page through user model.
When we created the <em>notes-list</em> component, we already configured the view and the behavior to fire that event, so we just need to update the user page and the user model:
<strong><em>root-folder</em>/app/js/components/user-page.js</strong> (<em>add 'RemoveUserNote' event handler</em>)</p>
<pre><code class="language-javascript">import Ractive from 'ractive';
import Template from '../../views/user-page.html';
import UserProfile from './user/profile-section';
import Repos from './user/repos-section';
import Notes from './user/notes-section';

var UserPage = Ractive.components.UserPage = Ractive.extend({
	template: Template,
	components: {
		UserProfile: UserProfile,
		Repos: Repos,
		Notes: Notes
	},
	oninit() {
		this.observe('req', (request) =&gt; {
			this.set('user', request.body.user);
		});

		// *.*, *.AddUserNote, AddNote.*, AddNote.AddUserNote
		this.on('*.AddUserNote', (newNote) =&gt; {
			console.log('UserPage::createNote# Adding new note to user:', this.get('user').profile.login);
			this.get('user').addNote(newNote);
		});

		this.on('*.RemoveUserNote', (note) =&gt; {
			this.get('user').removeNote(note);
		});
	}
});
UserPage._name = 'UserPage';

export default UserPage;
</code></pre>
<p><strong><em>root-folder</em>/app/js/models/user.js</strong> (<em>add 'removeNote' function</em>)</p>
<pre><code class="language-javascript">import * as ajax from '../plugins/ajax';

const GITHUB_BASE_URL = 'https://api.github.com';
const FIREBASE_BASE_URL = `https://ps-github-saver.firebaseio.com`;

class User {
	
	constructor(profile, repos, notes) {
		this.profile = profile;
		this.repos = repos;
		this.notes = notes || []; // Default parameters values are only valid for undefined ones
	}

	addNote(newNote) {
		this.notes.push(newNote);
		return ajax.putJson(`${FIREBASE_BASE_URL}/${this.profile.login.toLowerCase()}.json`, this.notes);
	}

	removeNote(note) {
		var index = this.notes.indexOf(note);
		if (index &gt;= 0) {
			this.notes.splice(index, 1);
			return ajax.putJson(`${FIREBASE_BASE_URL}/${this.profile.login.toLowerCase()}.json`, this.notes);
		}
	}

	static findByName(username) {
		let userProfileUrl = `${GITHUB_BASE_URL}/users/${username}`,
			userReposUrl = `${GITHUB_BASE_URL}/users/${username}/repos`,
			userNotesUrl = `${FIREBASE_BASE_URL}/${username.toLowerCase()}.json`;

		let result = new Promise((resolve, reject) =&gt; {
			Promise.all([
				ajax.getJson(userProfileUrl),
				ajax.getJson(userReposUrl),
				ajax.getJson(userNotesUrl)
			])
			.then(values =&gt; {
				resolve(new User(values[0], values[1], values[2]));
			})
			.catch(reject);
		});

		return result;
	}
}

export default User;
</code></pre>
<p>So, this is it.
You have used some of the main parts of Ractive along the way, but it has much more than this to offer.
I strongly recommend to (first) follow the <a href="http://learn.ractivejs.org/hello-world/1/">official tutorials</a> and (second) to read its <a href="http://docs.ractivejs.org/latest/get-started">documentation</a>.</p>
<p>We have some things we can improve with little effort in our application that we will accomplish in the last step of the tutorial.</p>
<hr>
<p>You can check the source code in <a href="https://github.com/PaquitoSoft/notetaker-ractive">this GitHub repo</a>.</p>
<hr>
<p>Previous post: <a href="/post/ractive-js-tutorial-loading-user-info">Loading user info</a>
Next post: <a href="/post/ractive-js-tutorial-the-final-touch">The final touch</a></p>
<hr>
</span></div><footer class="card_footer__5rntJ"><div>Published: <!-- -->02/08/2015</div></footer></article></div></section><aside><article class="about-me_aboutMeContainer__tBCGw"><header class="about-me_title__My_yA">About me</header><div><img class="about-me_avatar__rCHR2" src="/images/gravatar.jpg" alt="Paquitosoft avatar" height="150" width="150"/></div><footer class="about-me_footer__Io_kX"><ul><li class="about-me_profileLink__b1Ipw"><a href="https://github.com/PaquitoSoft" target="_blank" rel="noreferrer"><svg class="" height="24" width="24" fill="inherit"><path d="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"></path></svg></a></li><li class="about-me_profileLink__b1Ipw"><a href="https://twitter.com/telemaco82" target="_blank" rel="noreferrer"><svg class="" height="24" width="24" fill="inherit"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z"></path></svg></a></li><li class="about-me_profileLink__b1Ipw"><a href="hhtps://www.linkedin.com/in/carlos-martÃ­nez-cortizas-81763b2b" target="_blank" rel="noreferrer"><svg class="" height="24" width="24" fill="inherit"><path d="M19 3A2 2 0 0 1 21 5V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V5A2 2 0 0 1 5 3H19M18.5 18.5V13.2A3.26 3.26 0 0 0 15.24 9.94C14.39 9.94 13.4 10.46 12.92 11.24V10.13H10.13V18.5H12.92V13.57C12.92 12.8 13.54 12.17 14.31 12.17A1.4 1.4 0 0 1 15.71 13.57V18.5H18.5M6.88 8.56A1.68 1.68 0 0 0 8.56 6.88C8.56 5.95 7.81 5.19 6.88 5.19A1.69 1.69 0 0 0 5.19 6.88C5.19 7.81 5.95 8.56 6.88 8.56M8.27 18.5V10.13H5.5V18.5H8.27Z"></path></svg></a></li></ul></footer></article></aside></div></main><footer class="footer_footer__GaW5f">Developed using<a href="https://nextjs.org" target="_blank" rel="noreferrer">Next.js</a> and<a href="https://picocss.com/" target="_blank" rel="noreferrer">PicoCSS</a></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"ractive-js-tutorial-managing-users-notes","title":"Ractive.js tutorial - Managing user's notes (5 of 6)","creationDate":"2015-08-02T11:03:31.081Z","keywords":"tutorial, javascript, ractive, ractivejs","status":"published","excerpt":"\u003cp\u003e(\u003cem\u003ePrevious step: \u003ca href=\"/post/ractive-js-tutorial-loading-user-info\"\u003eLoading user info\u003c/a\u003e\u003c/em\u003e)\u003c/p\u003e\n\u003cp\u003eNow we want to add to our little application the ability to create and delete notes for the users we can already see.\nWe will have a collection of notes for every user.\u003c/p\u003e\n\u003cp\u003eWe need somewhere to store that notes and, for this tutorial, we'll use \u003ca href=\"https://www.firebase.com/\"\u003eFirebase\u003c/a\u003e free plan service.\nIf you don't have an account, go and create one. Once you have it, create a new APP from your account page.\nNow that you have your APP created, take note of its URL, as we'll be using it to integrate our application using \u003ca href=\"https://www.firebase.com/docs/rest/quickstart.html\"\u003eFirebase REST API\u003c/a\u003e.\nThe URL should be something like this: https://ps-github-saver.firebaseio.com/.\u003c/p\u003e\n\u003cp\u003eFirst of all, we're going to populate our notes component, as right now it's empty.\nWe could just put all the code in the \u003cem\u003enotes-section\u003c/em\u003e component, but for the sake of modularity (it would also help with the testing), we will have another two components:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eadd-note: a little component to handle notes creation.\u003c/li\u003e\n\u003cli\u003enotes-list: a little component to show current notes and allow removing them.\u003c/li\u003e\n\u003c/ul\u003e\n","content":"\u003cp\u003e(\u003cem\u003ePrevious step: \u003ca href=\"/post/ractive-js-tutorial-loading-user-info\"\u003eLoading user info\u003c/a\u003e\u003c/em\u003e)\u003c/p\u003e\n\u003cp\u003eNow we want to add to our little application the ability to create and delete notes for the users we can already see.\nWe will have a collection of notes for every user.\u003c/p\u003e\n\u003cp\u003eWe need somewhere to store that notes and, for this tutorial, we'll use \u003ca href=\"https://www.firebase.com/\"\u003eFirebase\u003c/a\u003e free plan service.\nIf you don't have an account, go and create one. Once you have it, create a new APP from your account page.\nNow that you have your APP created, take note of its URL, as we'll be using it to integrate our application using \u003ca href=\"https://www.firebase.com/docs/rest/quickstart.html\"\u003eFirebase REST API\u003c/a\u003e.\nThe URL should be something like this: https://ps-github-saver.firebaseio.com/.\u003c/p\u003e\n\u003cp\u003eFirst of all, we're going to populate our notes component, as right now it's empty.\nWe could just put all the code in the \u003cem\u003enotes-section\u003c/em\u003e component, but for the sake of modularity (it would also help with the testing), we will have another two components:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eadd-note: a little component to handle notes creation.\u003c/li\u003e\n\u003cli\u003enotes-list: a little component to show current notes and allow removing them.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eLet's go for the sub-components:\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/views/user/add-note.html\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026lt;form on-submit=\u0026quot;createNote\u0026quot;\u0026gt;\n\t\u0026lt;div class=\u0026quot;input-group\u0026quot;\u0026gt;\n\t\t\u0026lt;input type=\u0026quot;text\u0026quot; class=\u0026quot;form-control\u0026quot; value=\u0026quot;{{newNote}}\u0026quot; placeholder=\u0026quot;Add new note...\u0026quot; /\u0026gt;\n\t\t\u0026lt;span class=\u0026quot;input-group-btn\u0026quot;\u0026gt;\n\t\t\t\u0026lt;button class=\u0026quot;btn btn-default\u0026quot; type=\u0026quot;submit\u0026quot;\u0026gt; Add \u0026lt;/button\u0026gt;\n\t\t\u0026lt;/span\u0026gt;\n\t\u0026lt;/div\u0026gt;\n\u0026lt;/form\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/components/user/notes/add-note.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003eimport Ractive from 'ractive';\nimport User from '../../../models/user';\nimport Template from '../../../../views/user/notes/add-note.html';\n\nvar AddNote = Ractive.extend({\n\tisolated: true,\n\ttemplate: Template,\n\toninit: function() {\n\t\tthis.on('createNote', (rEvent) =\u0026gt; {\n\t\t\trEvent.original.preventDefault();\n\t\t\tthis.fire('AddUserNote', rEvent.context.newNote);\n\t\t\tthis.set('newNote', '');\n\t\t});\n\t},\n\tdata: {\n\t\tnewNote: ''\n\t}\n});\n\nexport default AddNote;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis component just shows an input with a button so we can type our note and proceed saving it.\nThe \u003cstrong\u003ecreateNote\u003c/strong\u003e proxy event just fires a custom event with the introduced note message.\nThis event will bubble up through all parent components so any of them (the right one) can handle it.\u003c/p\u003e\n\u003cp\u003eNow, the \u003cem\u003enotes-list\u003c/em\u003e component.\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/views/user/notes/notes-list.html\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026lt;ul class=\u0026quot;list-group\u0026quot;\u0026gt;\n\t{{#each notes}}\n\t\t\u0026lt;li class=\u0026quot;list-group-item\u0026quot;\u0026gt;\n\t\t\t\u0026lt;span\u0026gt;{{.}}\u0026lt;/span\u0026gt;\n\t\t\t\u0026lt;span class=\u0026quot;pull-right\u0026quot;\u0026gt;\n\t\t\t\t\u0026lt;span class=\u0026quot;glyphicon glyphicon-remove\u0026quot; on-click=\u0026quot;deleteNote\u0026quot; style=\u0026quot;cursor: pointer;\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\n\t\t\t\u0026lt;/span\u0026gt;\n\t\t\u0026lt;/li\u0026gt;\n\t{{/each}}\n\u0026lt;/ul\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/components/user/notes/notes-list.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003eimport Ractive from 'ractive';\nimport Template from '../../../views/user/notes/notes-list.html';\n\nvar NotesList = Ractive.extend({\n\tisolated: true,\n\ttemplate: Template,\n\toninit() {\n\t\tthis.on('deleteNote', (rEvent) =\u0026gt; {\n\t\t\t\tthis.fire('RemoveUserNote', rEvent.context);\n\t\t});\n\t}\n});\n\nexport default NotesList;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn the \u003cstrong\u003edeleteNote\u003c/strong\u003e proxy event, we just fire a custom event with the message we want to delete.\u003c/p\u003e\n\u003cp\u003eNow we need to update our \u003cem\u003enotes-section\u003c/em\u003e component so it uses those new sub-components:\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/views/user/notes-section.html\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026lt;div\u0026gt;\n\t\u0026lt;h3\u0026gt; Notes \u0026lt;/h3\u0026gt;\n\t\u0026lt;AddNote /\u0026gt;\n\t\u0026lt;br/\u0026gt;\n\t\u0026lt;NotesList notes=\u0026quot;{{notes}}\u0026quot; /\u0026gt;\n\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNote that we pass the notes list from the parent component to the \u003cem\u003enotes-list\u003c/em\u003e subcomponent.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/components/user/notes-section.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e'use strict';\n\nimport Ractive from 'ractive';\nimport AddNote from './notes/add-note';\nimport NotesList from './notes/notes-list';\nimport template from '../../views/user/notes-section.html';\n\nvar NotesSection = Ractive.extend({\n\tisolated: true,\n\ttemplate: template,\n\tcomponents: {\n\t\tAddNote: AddNote,\n\t\tNotesList: NotesList\n\t}\n});\n\nexport default NotesSection;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe just need to update our user page view to pass the notes collection to this section:\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/views/user-page.html\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026lt;div class=\u0026quot;row\u0026quot;\u0026gt;\n\t\u0026lt;div class=\u0026quot;col-md-4\u0026quot;\u0026gt;\n\t\t\u0026lt;UserProfile profile=\u0026quot;{{user.profile}}\u0026quot; /\u0026gt;\n\t\u0026lt;/div\u0026gt;\n\t\u0026lt;div class=\u0026quot;col-md-4\u0026quot;\u0026gt;\n\t\t\u0026lt;Repos repos=\u0026quot;{{user.repos}}\u0026quot; /\u0026gt;\n\t\u0026lt;/div\u0026gt;\n\t\u0026lt;div class=\u0026quot;col-md-4\u0026quot;\u0026gt;\n\t\t\u0026lt;Notes notes=\u0026quot;{{user.notes}}\u0026quot; /\u0026gt;\n\t\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe have all the notes stuff set up, but it's not functional yet as no one is managing reading and saving data to \u003cem\u003eFirebase\u003c/em\u003e.\nI think reading should be done in the \u003cstrong\u003efindByUsername\u003c/strong\u003e function from the user model object, so when the user page gets loaded, we have all its needed information.\nOn the other hand, creating and removing notes should be done from the user page component through the user model object. The user page component is the component who knows which user we're diplaying, so it will be the one listening to sub-component custom events.\u003c/p\u003e\n\u003cp\u003eLet's begin by reading user's notes.\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/models/user.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003eimport * as ajax from '../plugins/ajax';\n\nconst GITHUB_BASE_URL = 'https://api.github.com';\nconst FIREBASE_BASE_URL = `https://ps-github-saver.firebaseio.com`;\n\nclass User {\n\t\n\tconstructor(profile, repos, notes) {\n\t\tthis.profile = profile;\n\t\tthis.repos = repos;\n\t\tthis.notes = notes || []; // Default parameters values are only valid for undefined ones\n\t}\n\n\tstatic findByName(username) {\n\t\tlet userProfileUrl = `${GITHUB_BASE_URL}/users/${username}`,\n\t\t\tuserReposUrl = `${GITHUB_BASE_URL}/users/${username}/repos`,\n\t\t\tuserNotesUrl = `${FIREBASE_BASE_URL}/${username.toLowerCase()}.json`;\n\n\t\tlet result = new Promise((resolve, reject) =\u0026gt; {\n\t\t\tPromise.all([\n\t\t\t\tajax.getJson(userProfileUrl),\n\t\t\t\tajax.getJson(userReposUrl),\n\t\t\t\tajax.getJson(userNotesUrl)\n\t\t\t])\n\t\t\t.then(values =\u0026gt; {\n\t\t\t\t\tresolve(new User(values[0], values[1], values[2]));\n\t\t\t})\n\t\t\t.catch(reject);\n\t\t});\n\n\t\treturn result;\n\t}\n}\n\nexport default User;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe just need to declare the URL for the user's notes in our Firebase project and add another \u003cem\u003egetJson\u003c/em\u003e promise to our group.\u003c/p\u003e\n\u003cp\u003eNow we handle notes creation (in our user page component) so we can see anything in the notes list.\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/components/user-page.js\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003eimport Ractive from 'ractive';\nimport Template from '../../views/user-page.html';\nimport UserProfile from './user/profile-section';\nimport Repos from './user/repos-section';\nimport Notes from './user/notes-section';\n\nvar UserPage = Ractive.components.UserPage = Ractive.extend({\n\ttemplate: Template,\n\tcomponents: {\n\t\tUserProfile: UserProfile,\n\t\tRepos: Repos,\n\t\tNotes: Notes\n\t},\n\toninit() {\n\t\tthis.observe('req', (request) =\u0026gt; {\n\t\t\tthis.set('user', request.body.user);\n\t\t});\n\n\t\t// *.*, *.AddUserNote, AddNote.*, AddNote.AddUserNote\n\t\tthis.on('*.AddUserNote', (newNote) =\u0026gt; {\n\t\t\tconsole.log('UserPage::createNote# Adding new note to user:', this.get('user').profile.login);\n\t\t\tthis.get('user').addNote(newNote);\n\t\t});\n\t}\n});\nUserPage._name = 'UserPage';\n\nexport default UserPage;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe custom events fired from components get their names namespaced. The final event name is built beginning with the name of the component where it was generated, followed by a dot and the name you used when firing the event.\nWhen you register to events, you have the chance to use a wildcard both for the name of the component as well as the name of the event (see the comment above the event handler).\u003c/p\u003e\n\u003cp\u003eWe now need to implement the \u003cstrong\u003eaddNote\u003c/strong\u003e function in the user model.\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/models/user.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003eimport * as ajax from '../plugins/ajax';\n\nconst GITHUB_BASE_URL = 'https://api.github.com';\nconst FIREBASE_BASE_URL = `https://ps-github-saver.firebaseio.com`;\n\nclass User {\n\t\n\tconstructor(profile, repos, notes) {\n\t\tthis.profile = profile;\n\t\tthis.repos = repos;\n\t\tthis.notes = notes || []; // Default parameters values are only valid for undefined ones\n\t}\n\n\taddNote(newNote) {\n\t\tthis.notes.push(newNote);\n\t\treturn ajax.putJson(`${FIREBASE_BASE_URL}/${this.profile.login.toLowerCase()}.json`, this.notes);\n\t}\n\n\tstatic findByName(username) {\n\t\tlet userProfileUrl = `${GITHUB_BASE_URL}/users/${username}`,\n\t\t\tuserReposUrl = `${GITHUB_BASE_URL}/users/${username}/repos`,\n\t\t\tuserNotesUrl = `${FIREBASE_BASE_URL}/${username.toLowerCase()}.json`;\n\n\t\tlet result = new Promise((resolve, reject) =\u0026gt; {\n\t\t\tPromise.all([\n\t\t\t\tajax.getJson(userProfileUrl),\n\t\t\t\tajax.getJson(userReposUrl),\n\t\t\t\tajax.getJson(userNotesUrl)\n\t\t\t])\n\t\t\t.then(values =\u0026gt; {\n\t\t\t\tresolve(new User(values[0], values[1], values[2]));\n\t\t\t})\n\t\t\t.catch(reject);\n\t\t});\n\n\t\treturn result;\n\t}\n}\n\nexport default User;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eHere we're adding the new notes to the users note's list so it get updated inmediatly and Ractive will update the view to reflect this change before the note is actually persisted.\nThen, we call a new ajax pluging's function (\u003cem\u003eputJson\u003c/em\u003e) to save the note in Firebase.\u003c/p\u003e\n\u003cp\u003eMost of the time, save operation will work, so I prefer to not wait for the back-end response so the user feels our application is blazing fast.\nIn real world applications we would (for example) implement a mechanism so, if the operation fails, we warn the user and we undo the operation.\u003c/p\u003e\n\u003cp\u003eLet's add the \u003cstrong\u003eputJson\u003c/strong\u003e function to our ajax component:\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/plugins/ajax.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003efunction checkResponseStatus(res) {\n\tif (res.status \u0026lt; 400) {\n\t\treturn res;\n\t} else {\n\t\tlet error = new Error(res.statusText);\n\t\terror.statusCode = res.status;\n\t\terror.response = res;\n\t\tthrow error;\n\t}\n}\n\nfunction parseJson(res) {\n\treturn res.json();\n}\n\nexport function getJson(url, options = {cache: false}) {\n\treturn fetch(url)\n\t\t.then(checkResponseStatus)\n\t\t.then(parseJson);\n}\n\nexport function putJson(url, data) {\n\treturn fetch(url, {\n\t\tmethod: 'put',\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-Type': 'application/json'\n\t\t},\n\t\tbody: JSON.stringify(data)\n\t})\n\t.then(checkResponseStatus);\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIf you reload the application in your browser right now, you should be able to save notes.\u003c/p\u003e\n\u003cp\u003eThe last step is to add notes removing functionality.\nWe will follow the same pattern: fire a custom event from the sub-component (\u003cem\u003enotes-list\u003c/em\u003e) and handle it from the user page through user model.\nWhen we created the \u003cem\u003enotes-list\u003c/em\u003e component, we already configured the view and the behavior to fire that event, so we just need to update the user page and the user model:\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/components/user-page.js\u003c/strong\u003e (\u003cem\u003eadd 'RemoveUserNote' event handler\u003c/em\u003e)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003eimport Ractive from 'ractive';\nimport Template from '../../views/user-page.html';\nimport UserProfile from './user/profile-section';\nimport Repos from './user/repos-section';\nimport Notes from './user/notes-section';\n\nvar UserPage = Ractive.components.UserPage = Ractive.extend({\n\ttemplate: Template,\n\tcomponents: {\n\t\tUserProfile: UserProfile,\n\t\tRepos: Repos,\n\t\tNotes: Notes\n\t},\n\toninit() {\n\t\tthis.observe('req', (request) =\u0026gt; {\n\t\t\tthis.set('user', request.body.user);\n\t\t});\n\n\t\t// *.*, *.AddUserNote, AddNote.*, AddNote.AddUserNote\n\t\tthis.on('*.AddUserNote', (newNote) =\u0026gt; {\n\t\t\tconsole.log('UserPage::createNote# Adding new note to user:', this.get('user').profile.login);\n\t\t\tthis.get('user').addNote(newNote);\n\t\t});\n\n\t\tthis.on('*.RemoveUserNote', (note) =\u0026gt; {\n\t\t\tthis.get('user').removeNote(note);\n\t\t});\n\t}\n});\nUserPage._name = 'UserPage';\n\nexport default UserPage;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/models/user.js\u003c/strong\u003e (\u003cem\u003eadd 'removeNote' function\u003c/em\u003e)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003eimport * as ajax from '../plugins/ajax';\n\nconst GITHUB_BASE_URL = 'https://api.github.com';\nconst FIREBASE_BASE_URL = `https://ps-github-saver.firebaseio.com`;\n\nclass User {\n\t\n\tconstructor(profile, repos, notes) {\n\t\tthis.profile = profile;\n\t\tthis.repos = repos;\n\t\tthis.notes = notes || []; // Default parameters values are only valid for undefined ones\n\t}\n\n\taddNote(newNote) {\n\t\tthis.notes.push(newNote);\n\t\treturn ajax.putJson(`${FIREBASE_BASE_URL}/${this.profile.login.toLowerCase()}.json`, this.notes);\n\t}\n\n\tremoveNote(note) {\n\t\tvar index = this.notes.indexOf(note);\n\t\tif (index \u0026gt;= 0) {\n\t\t\tthis.notes.splice(index, 1);\n\t\t\treturn ajax.putJson(`${FIREBASE_BASE_URL}/${this.profile.login.toLowerCase()}.json`, this.notes);\n\t\t}\n\t}\n\n\tstatic findByName(username) {\n\t\tlet userProfileUrl = `${GITHUB_BASE_URL}/users/${username}`,\n\t\t\tuserReposUrl = `${GITHUB_BASE_URL}/users/${username}/repos`,\n\t\t\tuserNotesUrl = `${FIREBASE_BASE_URL}/${username.toLowerCase()}.json`;\n\n\t\tlet result = new Promise((resolve, reject) =\u0026gt; {\n\t\t\tPromise.all([\n\t\t\t\tajax.getJson(userProfileUrl),\n\t\t\t\tajax.getJson(userReposUrl),\n\t\t\t\tajax.getJson(userNotesUrl)\n\t\t\t])\n\t\t\t.then(values =\u0026gt; {\n\t\t\t\tresolve(new User(values[0], values[1], values[2]));\n\t\t\t})\n\t\t\t.catch(reject);\n\t\t});\n\n\t\treturn result;\n\t}\n}\n\nexport default User;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSo, this is it.\nYou have used some of the main parts of Ractive along the way, but it has much more than this to offer.\nI strongly recommend to (first) follow the \u003ca href=\"http://learn.ractivejs.org/hello-world/1/\"\u003eofficial tutorials\u003c/a\u003e and (second) to read its \u003ca href=\"http://docs.ractivejs.org/latest/get-started\"\u003edocumentation\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eWe have some things we can improve with little effort in our application that we will accomplish in the last step of the tutorial.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eYou can check the source code in \u003ca href=\"https://github.com/PaquitoSoft/notetaker-ractive\"\u003ethis GitHub repo\u003c/a\u003e.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003ePrevious post: \u003ca href=\"/post/ractive-js-tutorial-loading-user-info\"\u003eLoading user info\u003c/a\u003e\nNext post: \u003ca href=\"/post/ractive-js-tutorial-the-final-touch\"\u003eThe final touch\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n"},"_superjson":{"values":{"post.creationDate":["Date"]}}},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"ractive-js-tutorial-managing-users-notes"},"buildId":"Dhh1eIxwrKki7CqZexiwV","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>