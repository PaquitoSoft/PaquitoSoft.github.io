<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Ractive.js tutorial - Routing (3 of 6)</title><meta name="date" content="2015-08-01T15:15:44.447Z"/><meta name="keywords" content="tutorial, javascript, ractive, ractivejs"/><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/fca08b764e01d142.css" as="style"/><link rel="stylesheet" href="/_next/static/css/fca08b764e01d142.css" data-n-g=""/><link rel="preload" href="/_next/static/css/4727cb7922ba92a1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4727cb7922ba92a1.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-f6f8e789435065da.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-59f1ed9830ced99b.js" defer=""></script><script src="/_next/static/chunks/pages/_app-12e47b2d3cbfdb5e.js" defer=""></script><script src="/_next/static/chunks/834-1fce47b417d9f245.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-86b3e650bf853aa5.js" defer=""></script><script src="/_next/static/qDqkLNkeIvmmotP5mIhnk/_buildManifest.js" defer=""></script><script src="/_next/static/qDqkLNkeIvmmotP5mIhnk/_ssgManifest.js" defer=""></script><script src="/_next/static/qDqkLNkeIvmmotP5mIhnk/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><header class="header_header__U_Kza"><a class="title-link_titleLink__5zxWi header_title__DvyTk" href="/"><h2>Paquitosoft&#x27;s corner</h2></a></header><main class="container main-content"><div class="grid"><section><div><article class="card_card__43_8m"><header class="card_title__ITk4U"><h3>Ractive.js tutorial - Routing (3 of 6)</h3></header><div><span><p>(<em>Previous step</em>: <a href="/post/ractive-js-tutorial-creating-the-barebones">Creating the barebones</a>)</p>
<p><em>Ractive</em> does not have its own <a href="http://docs.ractivejs.org/latest/routing">routing system</a> becouse it is a library, not a framework, and routing is not part of its goal.
In the link above you can see they recommend:</p>
<ul>
<li><a href="http://backbonejs.org/#Router">Backbone.Router</a></li>
<li><a href="https://visionmedia.github.io/page.js/">PageJS</a></li>
</ul>
<p>There is also a Ractive specific router built by Martin Kolarik you can check:</p>
<ul>
<li><a href="https://github.com/MartinKolarik/ractive-route">Ractive-route</a></li>
</ul>
<p>As I already have some experience with <em>PageJS</em> I will be using that library for implementing a custom made routing subsystem.</p>
<h2>User page</h2>
<p>Right now we only have implemented our <em>home</em> page so let's begin by creating our <em>user</em> page.
This page will have three sections: Github user profile, Github user repos and our persisted notes about the user.
Let's create the sections and then, the page which uses them.</p>
<p><strong><em>root-folder</em>/app/views/user/profile-section.html</strong></p>
<pre><code class="language-html">&lt;div&gt;
	&lt;h3&gt; User Profile &lt;/h3&gt;
	&lt;ul class=&quot;list-group&quot;&gt;
		{{#profile.avatar_url}}&lt;li class=&quot;list-group-item&quot;&gt; &lt;img src={{profile.avatar_url}} class=&quot;img-rounded img-responsive&quot; style=&quot;min-height: 261px;&quot;/&gt;&lt;/li&gt;{{/profile.avatar_url}}
		{{#profile.name}}&lt;li class=&quot;list-group-item&quot;&gt;Name: {{profile.name}}&lt;/li&gt;{{/profile.name}}
		{{#profile.login}}&lt;li class=&quot;list-group-item&quot;&gt;Username: {{profile.login}}&lt;/li&gt;{{/profile.login}}
		{{#profile.email}}&lt;li class=&quot;list-group-item&quot;&gt;Email: {{profile.email}}&lt;/li&gt;{{/profile.email}}
		{{#profile.location}}&lt;li class=&quot;list-group-item&quot;&gt;Location: {{profile.location}}&lt;/li&gt;{{/profile.location}}
		{{#profile.company}}&lt;li class=&quot;list-group-item&quot;&gt;Company: {{profile.company}}&lt;/li&gt;{{/profile.company}}
		{{#profile.followers}}&lt;li class=&quot;list-group-item&quot;&gt;Followers: {{profile.followers}}&lt;/li&gt;{{/profile.followers}}
		{{#profile.following}}&lt;li class=&quot;list-group-item&quot;&gt;Following: {{profile.following}}&lt;/li&gt;{{/profile.following}}
		{{#profile.public_repos}}&lt;li class=&quot;list-group-item&quot;&gt;Public Repos: {{profile.public_repos}}&lt;/li&gt;{{/profile.public_repos}}
		{{#profile.blog}}&lt;li class=&quot;list-group-item&quot;&gt;Blog: &lt;a href=&quot;{{profile.blog}}&quot; target=&quot;_blank&quot;&gt;{{profile.blog}}&lt;/a&gt;&lt;/li&gt;{{/profile.blog}}
	&lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<p><strong><em>root-folder</em>/app/js/components/user/profile-section.js</strong></p>
<pre><code class="language-language-javascript">import Ractive from 'ractive';
import Template from '../../../views/user/profile-section.html';

var UserProfileSection = Ractive.extend({
		isolated: true,
	template: Template
});

export default UserProfileSection;
</code></pre>
<hr>
<p><strong><em>root-folder</em>/app/views/user/repos-section.html</strong></p>
<pre><code class="language-html">&lt;div&gt;
	&lt;h3&gt;User repos ({{repos.length}})&lt;/h3&gt;
	&lt;ul class=&quot;list-group&quot;&gt;
		{{#each repos}}
			&lt;li class=&quot;list-group-item&quot;&gt;
				{{#html_url}}
					&lt;h4&gt;&lt;a href=&quot;{{html_url}}&quot; target=&quot;_blank&quot;&gt;{{name}}&lt;/a&gt;&lt;/h4&gt;
				{{/html_url}}
				{{#description}}
					&lt;p&gt;{{description}}&lt;/p&gt;
				{{/description}}
			&lt;/li&gt;
		{{/each}}
	&lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<p><strong><em>root-folder</em>/app/js/components/user/repos-section.js</strong></p>
<pre><code class="language-language-javascript">import Ractive from 'ractive';
import Template from '../../../views/user/repos-section.html';

var ReposSection = Ractive.extend({
		isolated: true,
	template: Template
	// If we declare here data with attributes provided from
	// the template, it stops working
	// This is the nearest issue I found: https://github.com/ractivejs/ractive/issues/1977
	/*,
	data: {
			repos: []
	}*/
});

export default ReposSection;
</code></pre>
<hr>
<p><strong><em>root-folder</em>/app/views/user/notes-section.html</strong></p>
<pre><code class="language-html">&lt;div&gt;
	&lt;h3&gt; Notes &lt;/h3&gt;
	&lt;p&gt;To be filled later...&lt;/p&gt;
&lt;/div&gt;
</code></pre>
<p><strong><em>root-folder</em>/app/js/components/user/notes-section.js</strong></p>
<pre><code class="language-language-javascript">'use strict';

import Ractive from 'ractive';
import Template from '../../../views/user/notes-section.html';

var NotesSection = Ractive.extend({
		isolated: true,
	template: Template
});

export default NotesSection;
</code></pre>
<hr>
<p>Finally, our <em>user</em> page which uses previous sections:
<strong><em>root-folder</em>/app/views/user-page.html</strong></p>
<pre><code class="language-html">&lt;div class=&quot;row&quot;&gt;
	&lt;div class=&quot;col-md-4&quot;&gt;
		&lt;UserProfile /&gt;
	&lt;/div&gt;
	&lt;div class=&quot;col-md-4&quot;&gt;
		&lt;Repos /&gt;
	&lt;/div&gt;
	&lt;div class=&quot;col-md-4&quot;&gt;
		&lt;Notes /&gt;
	&lt;/div&gt;
&lt;/div&gt;
</code></pre>
<p><strong><em>root-folder</em>/app/js/components/user-page.js</strong></p>
<pre><code class="language-language-javascript">import Ractive from 'ractive';
import Template from '../../views/user-page.html';
import UserProfile from './user/profile-section';
import Repos from './user/repos-section';
import Notes from './user/notes-section';

var UserPage = Ractive.extend({
		template: Template,
	components: {
			UserProfile: UserProfile,
		Repos: Repos,
		Notes: Notes
	}
});

export default UserPage;
</code></pre>
<p>Now, to check that everything is ok, we can update the <em>App</em> to render this page instead of the home page.</p>
<p>Modify these files like this:
<strong><em>root-folder</em>/app/js/app.js</strong> (import and declare the new user page component):</p>
<pre><code class="language-language-javascript">import Ractive from 'ractive';
import template from '../views/app.html';
import SearchUserComponent from './components/layout/search-user';
import HomePageComponent from './components/home-page';
import UserPageComponent from './components/user-page'

let App = new Ractive({
	  el: '#app',
  template: template,
  components: {
	  	SearchUser: SearchUserComponent,
  	HomePage: HomePageComponent,
  	UserPage: UserPageComponent
  }
});

export default App;
</code></pre>
<p><strong><em>root-folder</em>/app/views/app.html</strong> (change the main section)</p>
<pre><code class="language-html">&lt;div class=&quot;main-container&quot;&gt;
	&lt;nav class=&quot;navbar navbar-default&quot; role=&quot;navigation&quot;&gt;
		&lt;div class=&quot;col-sm-1&quot;&gt;
			&lt;a href=&quot;/&quot;&gt;
				&lt;h3&gt;Notetaker&lt;/h3&gt;
			&lt;/a&gt;
		&lt;/div&gt;
		&lt;div class=&quot;col-sm-7 col-sm-offset-1&quot; style=&quot;margin-top: 15px;&quot;&gt;
			&lt;SearchUser placeholder=&quot;Type a GitHub username...&quot; /&gt;
		&lt;/div&gt;
	&lt;/nav&gt;
	&lt;div class=&quot;container&quot;&gt;
		&lt;UserPage /&gt;
	&lt;/div&gt;
&lt;/div&gt;
</code></pre>
<p>If you load the appliction right now, you should see something like this:
<img src="/content/images/2015/08/ractive-tutorial-06.png" alt=""></p>
<h2>Router component</h2>
<p>Great, let's talk about routing...
Right now, in our application template we're telling which page to use with this section:</p>
<pre><code class="language-html">&lt;div class=&quot;container&quot;&gt;
  &lt;UserPage/&gt;
&lt;/div&gt;
</code></pre>
<p>We want to use a custom component that uses the page component corresponding to the current route.
We will be creating a <em>Route</em> component which accepts an attribute indicating which page component it should render.
<strong><em>root-folder</em>/app/js/component/layout/router.js</strong></p>
<pre><code class="language-language-javascript">import Ractive from 'ractive';

/*
	This router has been built on top of the ideas from this Stack Overflow question:
	http://stackoverflow.com/questions/31075341/how-to-create-ractives-subcomponents-dynamically-and-change-them-programmatical
*/

var Router = Ractive.extend({
		template: '&lt;router-handler/&gt;',
	components: {
			'router-handler': function() {
				return this.get('componentName');
		}
	},
	oninit: function() {
			this.observe('componentName', function(newValue, oldValue) {
				if (this.fragment.rendered) {
					this.reset();
			}
		});
	}
});

export default Router;
</code></pre>
<p>There are a lot of things happening here:</p>
<ol>
<li>The template is very basic as it just needs what page component to use. We define a <em>route-handler</em> inner component which is linked in the second step.</li>
<li>We define the inner component so that instead of being a component class, it is a function that returns the page component it should use. The page component will be a router data attribute which will be updated from the <em>App</em>. Take note that we don't define this component as isolated as we want it to be aware of the page component it should render, which will be handled from the <em>App</em> instance.</li>
<li>When this <em>router</em> component is initialized, it registers a listener on the <em>componentName</em> data attribute from its context (which inherits from its parent, <em>App</em> instance) so that, every time it gets updated, this component calls its <strong>reset</strong> function, which causes it to re-render, using the new page component set in the <em>componentName</em> attribute.</li>
<li>We have a conditional statement so we don't do this if the component has not been already rendered for the first time (bootstraping).</li>
</ol>
<p>Now we need to update our <em>App</em> instance so it makes use of this new component, instead of setting in its template which page component to use.
<strong><em>root-folder</em>/app/views/app.html</strong></p>
<pre><code class="language-html">&lt;div class=&quot;main-container&quot;&gt;
	&lt;nav class=&quot;navbar navbar-default&quot; role=&quot;navigation&quot;&gt;
		&lt;div class=&quot;col-sm-1&quot;&gt;
			&lt;a href=&quot;/&quot;&gt;
				&lt;h3&gt;Notetaker&lt;/h3&gt;
			&lt;/a&gt;
		&lt;/div&gt;
		&lt;div class=&quot;col-sm-7 col-sm-offset-1&quot; style=&quot;margin-top: 15px;&quot;&gt;
			&lt;SearchUser placeholder=&quot;Type a GitHub username...&quot; /&gt;
		&lt;/div&gt;
	&lt;/nav&gt;
	&lt;div class=&quot;container&quot;&gt;
		&lt;Router componentName=&quot;{{componentName}}&quot;/&gt;
	&lt;/div&gt;
&lt;/div&gt;
</code></pre>
<p>Take note about the attribute we're passing to Router component from the markup.</p>
<p>We also need to update the <em>App</em> to create the <em>componentName</em> property so we can handle there the value for the page we must show.</p>
<pre><code class="language-language-javascript">import Ractive from 'ractive';
import template from '../views/app.html';
import SearchUserComponent from './components/layout/search-user';
import HomePageComponent from './components/home-page';
import UserPageComponent from './components/user-page'

let App = new Ractive({
	  el: '#app',
  template: template,
  components: {
	  	SearchUser: SearchUserComponent,
  	HomePage: HomePageComponent,
  	UserPage: UserPageComponent
  },
  data: {
	  	componentName: 'HomePage'
  }
});

export default App;
</code></pre>
<p>Now, if you reload your browser, you should see the <em>home</em> page again, and, if you change the <em>componentName</em> data attribute from <em>HomePage</em> to <em>UserPage</em> and reload your browser again, you should see the user page instead.</p>
<p>Ok, so now we have the ability to show different pages from the <em>App</em>, but how do we link this to URL changes and how do we navigate from one to another?
This is when we begin using <a href="https://visionmedia.github.io/page.js/">PageJS</a>. Like every other routing library, it allows us to be notified when the URL changes, it can force URL changes and it also allows to handle redirects.</p>
<p>Take a moment to install the library in our project:</p>
<pre><code>$ npm install page --save
</code></pre>
<p>We will create our own library module on top of <em>PageJS</em> which will be initialized from our <em>App</em> instance, getting passed the routing configuration, so it knows which function is has to invoke for every registerd route.</p>
<p>Let's begin by defining routing configuration module:
<strong><em>root-folder</em>/app/js/config/routes.js</strong></p>
<pre><code class="language-language-javascript">'use strict';

import router from '../plugins/router';
import HomePage from '../components/home-page';
import UserPage from '../components/user-page';

var routes = new Map();

routes.set('/', (context, next) =&gt; {
		next(null, HomePage);
});

routes.set('/user/:username', (context, next) =&gt; {
		next(null, UserPage);
});

export default routes;
</code></pre>
<p>Now, the router module:
<strong><em>root-folder</em>/app/js/plugins/router.js</strong></p>
<pre><code class="language-language-javascript">import page from 'page';
import Ractive from 'ractive';

function navigationHandler(routeHandler, onNavigation) {
		return function(context/*, next*/) {
			routeHandler(context, (error, PageComponent = {}, data = {}) =&gt; {
				context.pageName = PageComponent._name;
			context.state = data;
			onNavigation(error, context);
		})
	};
}

export function init(routes, onNavigation) {
	
	routes.forEach((routeHandler, path) =&gt; {
			page(path, navigationHandler(routeHandler, onNavigation));
	});

	page({
			hashbang: true
	});
}

export function navTo(url) {
		page.show(url);
}
</code></pre>
<p>The <em>init</em> function gets the configuration map and a callback as parameters. The second one will be invoked after the router handler gets executed with a <em>context</em> object containing routing information and the data passed from the route handler function (defined in the <em>routes.js</em> filed).
The last line in this file initializes <em>PageJS</em> so, by default, it intercepts all links and checks if we have a handler configured for them.
We also pass the configuration <em>hashbang: true</em> so we don't use HTML5 <em>pushState</em> and use the URL hash fragment instead, as we won't be using a server and the application would fail if we try to load an URL like this: http://localhost:8080/user/paquitosoft.</p>
<p>This file also has a <em>navTo</em> function so we can programatically navigate to any route. We will use it from our <em>SearchUser</em> component.</p>
<p>Ok, lets update our <em>App</em> instance to deal with routing with all we have done until now:
<strong><em>root-folder</em>/app/js/app.js</strong></p>
<pre><code class="language-language-javascript">import Ractive from 'ractive';
import template from '../views/app.html';

import * as RouterPlugin from './plugins/router';
import routesConfiguration from './config/routes';

import RouterComponent from './components/layout/router';
import SearchUserComponent from './components/layout/search-user';
import HomePageComponent from './components/home-page';
import UserPageComponent from './components/user-page'

let App = new Ractive({
		el: '#app',
	template: template,
	components: {
			SearchUser: SearchUserComponent,
		Router: RouterComponent,
		HomePage: HomePageComponent,
		UserPage: UserPageComponent
	},
	data: {
			componentName: 'HomePage'
	},
	oninit() {
			RouterPlugin.init(routesConfiguration, this.onNavigation.bind(this));
		console.log('App::oninit# Application initialized!');
	},
	onNavigation(error, navigationContext) {
			console.log('APP::onNavigation# Navigating to:', navigationContext.pageName, 'with context:', navigationContext);

		if (error) {
				console.warn('App::onNavigation# Error navigating:', error);
		} else {
				this.set({
					req: {
						params: navigationContext.params,
					body: navigationContext.state
				},
				componentName: navigationContext.pageName
			});
		}
	}
});

export default App;
</code></pre>
<p>Now, when the <em>App</em> is initialized, it configures the route module passing the routes configuration and a callback function.
When the callback gets called, we update the data context setting the <em>componentName</em> attribute to the name of the page component we need to show. The value gets to this function in the <em>navigationContext</em> parameter which gets passed from the router plugin, which gets it from the routes configuration the <em>App</em> passed upon initialization.</p>
<p>The last touch is to update the home page so we can test our navigation:
<strong><em>root-folder</em>/app/views/app.html</strong></p>
<pre><code class="language-html">&lt;h2 class=&quot;text-center&quot;&gt;
	Search by Github username above
&lt;/h2&gt;
&lt;p&gt;
	Nav to &lt;a href=&quot;/user/paquitosoft&quot;&gt;User Page&lt;/a&gt;
&lt;/p&gt;
</code></pre>
<p>Now, if you load the home page on your browser (http://localhost:8080/), you should see this:
<img src="/content/images/2015/08/ractive-tutorial-07.png" alt=""></p>
<p>You can follow the lower-left link to load the user page and use the upper-left (<em>Notetaker</em>) title link to get back to the home page.
(_Remember to remove the lower-left link once you're done with your tests).</p>
<hr>
<p>You can check the source code in <a href="https://github.com/PaquitoSoft/notetaker-ractive">this GitHub repo</a>.</p>
<hr>
<p>Previous post: <a href="/post/ractive-js-tutorial-creating-the-barebones">Creating the barebones</a>
Next post: <a href="/post/ractive-js-tutorial-loading-user-info">Loading user info</a></p>
<hr>
</span></div><footer class="card_footer__5rntJ"><div>Published: <!-- -->01/08/2015</div></footer></article></div></section><aside><article class="about-me_aboutMeContainer__tBCGw"><header class="about-me_title__My_yA">About me</header><div><img class="about-me_avatar__rCHR2" src="/images/gravatar.jpg" alt="Paquitosoft avatar" height="150" width="150"/></div><footer class="about-me_footer__Io_kX"><ul><li class="about-me_profileLink__b1Ipw"><a href="https://github.com/PaquitoSoft" target="_blank" rel="noreferrer"><svg class="" height="24" width="24" fill="inherit"><path d="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"></path></svg></a></li><li class="about-me_profileLink__b1Ipw"><a href="https://twitter.com/telemaco82" target="_blank" rel="noreferrer"><svg class="" height="24" width="24" fill="inherit"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z"></path></svg></a></li><li class="about-me_profileLink__b1Ipw"><a href="hhtps://www.linkedin.com/in/carlos-martÃ­nez-cortizas-81763b2b" target="_blank" rel="noreferrer"><svg class="" height="24" width="24" fill="inherit"><path d="M19 3A2 2 0 0 1 21 5V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V5A2 2 0 0 1 5 3H19M18.5 18.5V13.2A3.26 3.26 0 0 0 15.24 9.94C14.39 9.94 13.4 10.46 12.92 11.24V10.13H10.13V18.5H12.92V13.57C12.92 12.8 13.54 12.17 14.31 12.17A1.4 1.4 0 0 1 15.71 13.57V18.5H18.5M6.88 8.56A1.68 1.68 0 0 0 8.56 6.88C8.56 5.95 7.81 5.19 6.88 5.19A1.69 1.69 0 0 0 5.19 6.88C5.19 7.81 5.95 8.56 6.88 8.56M8.27 18.5V10.13H5.5V18.5H8.27Z"></path></svg></a></li></ul></footer></article></aside></div></main><footer class="footer_footer__GaW5f">Developed using<a href="https://nextjs.org" target="_blank" rel="noreferrer">Next.js</a> and<a href="https://picocss.com/" target="_blank" rel="noreferrer">PicoCSS</a></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"ractive-js-tutorial-routing","title":"Ractive.js tutorial - Routing (3 of 6)","creationDate":"2015-08-01T15:15:44.447Z","keywords":"tutorial, javascript, ractive, ractivejs","status":"published","excerpt":"\u003cp\u003e(\u003cem\u003ePrevious step\u003c/em\u003e: \u003ca href=\"/post/ractive-js-tutorial-creating-the-barebones\"\u003eCreating the barebones\u003c/a\u003e)\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eRactive\u003c/em\u003e does not have its own \u003ca href=\"http://docs.ractivejs.org/latest/routing\"\u003erouting system\u003c/a\u003e becouse it is a library, not a framework, and routing is not part of its goal.\nIn the link above you can see they recommend:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://backbonejs.org/#Router\"\u003eBackbone.Router\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://visionmedia.github.io/page.js/\"\u003ePageJS\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThere is also a Ractive specific router built by Martin Kolarik you can check:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/MartinKolarik/ractive-route\"\u003eRactive-route\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAs I already have some experience with \u003cem\u003ePageJS\u003c/em\u003e I will be using that library for implementing a custom made routing subsystem.\u003c/p\u003e\n","content":"\u003cp\u003e(\u003cem\u003ePrevious step\u003c/em\u003e: \u003ca href=\"/post/ractive-js-tutorial-creating-the-barebones\"\u003eCreating the barebones\u003c/a\u003e)\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eRactive\u003c/em\u003e does not have its own \u003ca href=\"http://docs.ractivejs.org/latest/routing\"\u003erouting system\u003c/a\u003e becouse it is a library, not a framework, and routing is not part of its goal.\nIn the link above you can see they recommend:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://backbonejs.org/#Router\"\u003eBackbone.Router\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://visionmedia.github.io/page.js/\"\u003ePageJS\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThere is also a Ractive specific router built by Martin Kolarik you can check:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/MartinKolarik/ractive-route\"\u003eRactive-route\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAs I already have some experience with \u003cem\u003ePageJS\u003c/em\u003e I will be using that library for implementing a custom made routing subsystem.\u003c/p\u003e\n\u003ch2\u003eUser page\u003c/h2\u003e\n\u003cp\u003eRight now we only have implemented our \u003cem\u003ehome\u003c/em\u003e page so let's begin by creating our \u003cem\u003euser\u003c/em\u003e page.\nThis page will have three sections: Github user profile, Github user repos and our persisted notes about the user.\nLet's create the sections and then, the page which uses them.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/views/user/profile-section.html\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026lt;div\u0026gt;\n\t\u0026lt;h3\u0026gt; User Profile \u0026lt;/h3\u0026gt;\n\t\u0026lt;ul class=\u0026quot;list-group\u0026quot;\u0026gt;\n\t\t{{#profile.avatar_url}}\u0026lt;li class=\u0026quot;list-group-item\u0026quot;\u0026gt; \u0026lt;img src={{profile.avatar_url}} class=\u0026quot;img-rounded img-responsive\u0026quot; style=\u0026quot;min-height: 261px;\u0026quot;/\u0026gt;\u0026lt;/li\u0026gt;{{/profile.avatar_url}}\n\t\t{{#profile.name}}\u0026lt;li class=\u0026quot;list-group-item\u0026quot;\u0026gt;Name: {{profile.name}}\u0026lt;/li\u0026gt;{{/profile.name}}\n\t\t{{#profile.login}}\u0026lt;li class=\u0026quot;list-group-item\u0026quot;\u0026gt;Username: {{profile.login}}\u0026lt;/li\u0026gt;{{/profile.login}}\n\t\t{{#profile.email}}\u0026lt;li class=\u0026quot;list-group-item\u0026quot;\u0026gt;Email: {{profile.email}}\u0026lt;/li\u0026gt;{{/profile.email}}\n\t\t{{#profile.location}}\u0026lt;li class=\u0026quot;list-group-item\u0026quot;\u0026gt;Location: {{profile.location}}\u0026lt;/li\u0026gt;{{/profile.location}}\n\t\t{{#profile.company}}\u0026lt;li class=\u0026quot;list-group-item\u0026quot;\u0026gt;Company: {{profile.company}}\u0026lt;/li\u0026gt;{{/profile.company}}\n\t\t{{#profile.followers}}\u0026lt;li class=\u0026quot;list-group-item\u0026quot;\u0026gt;Followers: {{profile.followers}}\u0026lt;/li\u0026gt;{{/profile.followers}}\n\t\t{{#profile.following}}\u0026lt;li class=\u0026quot;list-group-item\u0026quot;\u0026gt;Following: {{profile.following}}\u0026lt;/li\u0026gt;{{/profile.following}}\n\t\t{{#profile.public_repos}}\u0026lt;li class=\u0026quot;list-group-item\u0026quot;\u0026gt;Public Repos: {{profile.public_repos}}\u0026lt;/li\u0026gt;{{/profile.public_repos}}\n\t\t{{#profile.blog}}\u0026lt;li class=\u0026quot;list-group-item\u0026quot;\u0026gt;Blog: \u0026lt;a href=\u0026quot;{{profile.blog}}\u0026quot; target=\u0026quot;_blank\u0026quot;\u0026gt;{{profile.blog}}\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;{{/profile.blog}}\n\t\u0026lt;/ul\u0026gt;\n\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/components/user/profile-section.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-language-javascript\"\u003eimport Ractive from 'ractive';\nimport Template from '../../../views/user/profile-section.html';\n\nvar UserProfileSection = Ractive.extend({\n\t\tisolated: true,\n\ttemplate: Template\n});\n\nexport default UserProfileSection;\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/views/user/repos-section.html\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026lt;div\u0026gt;\n\t\u0026lt;h3\u0026gt;User repos ({{repos.length}})\u0026lt;/h3\u0026gt;\n\t\u0026lt;ul class=\u0026quot;list-group\u0026quot;\u0026gt;\n\t\t{{#each repos}}\n\t\t\t\u0026lt;li class=\u0026quot;list-group-item\u0026quot;\u0026gt;\n\t\t\t\t{{#html_url}}\n\t\t\t\t\t\u0026lt;h4\u0026gt;\u0026lt;a href=\u0026quot;{{html_url}}\u0026quot; target=\u0026quot;_blank\u0026quot;\u0026gt;{{name}}\u0026lt;/a\u0026gt;\u0026lt;/h4\u0026gt;\n\t\t\t\t{{/html_url}}\n\t\t\t\t{{#description}}\n\t\t\t\t\t\u0026lt;p\u0026gt;{{description}}\u0026lt;/p\u0026gt;\n\t\t\t\t{{/description}}\n\t\t\t\u0026lt;/li\u0026gt;\n\t\t{{/each}}\n\t\u0026lt;/ul\u0026gt;\n\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/components/user/repos-section.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-language-javascript\"\u003eimport Ractive from 'ractive';\nimport Template from '../../../views/user/repos-section.html';\n\nvar ReposSection = Ractive.extend({\n\t\tisolated: true,\n\ttemplate: Template\n\t// If we declare here data with attributes provided from\n\t// the template, it stops working\n\t// This is the nearest issue I found: https://github.com/ractivejs/ractive/issues/1977\n\t/*,\n\tdata: {\n\t\t\trepos: []\n\t}*/\n});\n\nexport default ReposSection;\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/views/user/notes-section.html\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026lt;div\u0026gt;\n\t\u0026lt;h3\u0026gt; Notes \u0026lt;/h3\u0026gt;\n\t\u0026lt;p\u0026gt;To be filled later...\u0026lt;/p\u0026gt;\n\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/components/user/notes-section.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-language-javascript\"\u003e'use strict';\n\nimport Ractive from 'ractive';\nimport Template from '../../../views/user/notes-section.html';\n\nvar NotesSection = Ractive.extend({\n\t\tisolated: true,\n\ttemplate: Template\n});\n\nexport default NotesSection;\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003cp\u003eFinally, our \u003cem\u003euser\u003c/em\u003e page which uses previous sections:\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/views/user-page.html\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026lt;div class=\u0026quot;row\u0026quot;\u0026gt;\n\t\u0026lt;div class=\u0026quot;col-md-4\u0026quot;\u0026gt;\n\t\t\u0026lt;UserProfile /\u0026gt;\n\t\u0026lt;/div\u0026gt;\n\t\u0026lt;div class=\u0026quot;col-md-4\u0026quot;\u0026gt;\n\t\t\u0026lt;Repos /\u0026gt;\n\t\u0026lt;/div\u0026gt;\n\t\u0026lt;div class=\u0026quot;col-md-4\u0026quot;\u0026gt;\n\t\t\u0026lt;Notes /\u0026gt;\n\t\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/components/user-page.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-language-javascript\"\u003eimport Ractive from 'ractive';\nimport Template from '../../views/user-page.html';\nimport UserProfile from './user/profile-section';\nimport Repos from './user/repos-section';\nimport Notes from './user/notes-section';\n\nvar UserPage = Ractive.extend({\n\t\ttemplate: Template,\n\tcomponents: {\n\t\t\tUserProfile: UserProfile,\n\t\tRepos: Repos,\n\t\tNotes: Notes\n\t}\n});\n\nexport default UserPage;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow, to check that everything is ok, we can update the \u003cem\u003eApp\u003c/em\u003e to render this page instead of the home page.\u003c/p\u003e\n\u003cp\u003eModify these files like this:\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/app.js\u003c/strong\u003e (import and declare the new user page component):\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-language-javascript\"\u003eimport Ractive from 'ractive';\nimport template from '../views/app.html';\nimport SearchUserComponent from './components/layout/search-user';\nimport HomePageComponent from './components/home-page';\nimport UserPageComponent from './components/user-page'\n\nlet App = new Ractive({\n\t  el: '#app',\n  template: template,\n  components: {\n\t  \tSearchUser: SearchUserComponent,\n  \tHomePage: HomePageComponent,\n  \tUserPage: UserPageComponent\n  }\n});\n\nexport default App;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/views/app.html\u003c/strong\u003e (change the main section)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026lt;div class=\u0026quot;main-container\u0026quot;\u0026gt;\n\t\u0026lt;nav class=\u0026quot;navbar navbar-default\u0026quot; role=\u0026quot;navigation\u0026quot;\u0026gt;\n\t\t\u0026lt;div class=\u0026quot;col-sm-1\u0026quot;\u0026gt;\n\t\t\t\u0026lt;a href=\u0026quot;/\u0026quot;\u0026gt;\n\t\t\t\t\u0026lt;h3\u0026gt;Notetaker\u0026lt;/h3\u0026gt;\n\t\t\t\u0026lt;/a\u0026gt;\n\t\t\u0026lt;/div\u0026gt;\n\t\t\u0026lt;div class=\u0026quot;col-sm-7 col-sm-offset-1\u0026quot; style=\u0026quot;margin-top: 15px;\u0026quot;\u0026gt;\n\t\t\t\u0026lt;SearchUser placeholder=\u0026quot;Type a GitHub username...\u0026quot; /\u0026gt;\n\t\t\u0026lt;/div\u0026gt;\n\t\u0026lt;/nav\u0026gt;\n\t\u0026lt;div class=\u0026quot;container\u0026quot;\u0026gt;\n\t\t\u0026lt;UserPage /\u0026gt;\n\t\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIf you load the appliction right now, you should see something like this:\n\u003cimg src=\"/content/images/2015/08/ractive-tutorial-06.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2\u003eRouter component\u003c/h2\u003e\n\u003cp\u003eGreat, let's talk about routing...\nRight now, in our application template we're telling which page to use with this section:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026lt;div class=\u0026quot;container\u0026quot;\u0026gt;\n  \u0026lt;UserPage/\u0026gt;\n\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe want to use a custom component that uses the page component corresponding to the current route.\nWe will be creating a \u003cem\u003eRoute\u003c/em\u003e component which accepts an attribute indicating which page component it should render.\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/component/layout/router.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-language-javascript\"\u003eimport Ractive from 'ractive';\n\n/*\n\tThis router has been built on top of the ideas from this Stack Overflow question:\n\thttp://stackoverflow.com/questions/31075341/how-to-create-ractives-subcomponents-dynamically-and-change-them-programmatical\n*/\n\nvar Router = Ractive.extend({\n\t\ttemplate: '\u0026lt;router-handler/\u0026gt;',\n\tcomponents: {\n\t\t\t'router-handler': function() {\n\t\t\t\treturn this.get('componentName');\n\t\t}\n\t},\n\toninit: function() {\n\t\t\tthis.observe('componentName', function(newValue, oldValue) {\n\t\t\t\tif (this.fragment.rendered) {\n\t\t\t\t\tthis.reset();\n\t\t\t}\n\t\t});\n\t}\n});\n\nexport default Router;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThere are a lot of things happening here:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe template is very basic as it just needs what page component to use. We define a \u003cem\u003eroute-handler\u003c/em\u003e inner component which is linked in the second step.\u003c/li\u003e\n\u003cli\u003eWe define the inner component so that instead of being a component class, it is a function that returns the page component it should use. The page component will be a router data attribute which will be updated from the \u003cem\u003eApp\u003c/em\u003e. Take note that we don't define this component as isolated as we want it to be aware of the page component it should render, which will be handled from the \u003cem\u003eApp\u003c/em\u003e instance.\u003c/li\u003e\n\u003cli\u003eWhen this \u003cem\u003erouter\u003c/em\u003e component is initialized, it registers a listener on the \u003cem\u003ecomponentName\u003c/em\u003e data attribute from its context (which inherits from its parent, \u003cem\u003eApp\u003c/em\u003e instance) so that, every time it gets updated, this component calls its \u003cstrong\u003ereset\u003c/strong\u003e function, which causes it to re-render, using the new page component set in the \u003cem\u003ecomponentName\u003c/em\u003e attribute.\u003c/li\u003e\n\u003cli\u003eWe have a conditional statement so we don't do this if the component has not been already rendered for the first time (bootstraping).\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eNow we need to update our \u003cem\u003eApp\u003c/em\u003e instance so it makes use of this new component, instead of setting in its template which page component to use.\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/views/app.html\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026lt;div class=\u0026quot;main-container\u0026quot;\u0026gt;\n\t\u0026lt;nav class=\u0026quot;navbar navbar-default\u0026quot; role=\u0026quot;navigation\u0026quot;\u0026gt;\n\t\t\u0026lt;div class=\u0026quot;col-sm-1\u0026quot;\u0026gt;\n\t\t\t\u0026lt;a href=\u0026quot;/\u0026quot;\u0026gt;\n\t\t\t\t\u0026lt;h3\u0026gt;Notetaker\u0026lt;/h3\u0026gt;\n\t\t\t\u0026lt;/a\u0026gt;\n\t\t\u0026lt;/div\u0026gt;\n\t\t\u0026lt;div class=\u0026quot;col-sm-7 col-sm-offset-1\u0026quot; style=\u0026quot;margin-top: 15px;\u0026quot;\u0026gt;\n\t\t\t\u0026lt;SearchUser placeholder=\u0026quot;Type a GitHub username...\u0026quot; /\u0026gt;\n\t\t\u0026lt;/div\u0026gt;\n\t\u0026lt;/nav\u0026gt;\n\t\u0026lt;div class=\u0026quot;container\u0026quot;\u0026gt;\n\t\t\u0026lt;Router componentName=\u0026quot;{{componentName}}\u0026quot;/\u0026gt;\n\t\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTake note about the attribute we're passing to Router component from the markup.\u003c/p\u003e\n\u003cp\u003eWe also need to update the \u003cem\u003eApp\u003c/em\u003e to create the \u003cem\u003ecomponentName\u003c/em\u003e property so we can handle there the value for the page we must show.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-language-javascript\"\u003eimport Ractive from 'ractive';\nimport template from '../views/app.html';\nimport SearchUserComponent from './components/layout/search-user';\nimport HomePageComponent from './components/home-page';\nimport UserPageComponent from './components/user-page'\n\nlet App = new Ractive({\n\t  el: '#app',\n  template: template,\n  components: {\n\t  \tSearchUser: SearchUserComponent,\n  \tHomePage: HomePageComponent,\n  \tUserPage: UserPageComponent\n  },\n  data: {\n\t  \tcomponentName: 'HomePage'\n  }\n});\n\nexport default App;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow, if you reload your browser, you should see the \u003cem\u003ehome\u003c/em\u003e page again, and, if you change the \u003cem\u003ecomponentName\u003c/em\u003e data attribute from \u003cem\u003eHomePage\u003c/em\u003e to \u003cem\u003eUserPage\u003c/em\u003e and reload your browser again, you should see the user page instead.\u003c/p\u003e\n\u003cp\u003eOk, so now we have the ability to show different pages from the \u003cem\u003eApp\u003c/em\u003e, but how do we link this to URL changes and how do we navigate from one to another?\nThis is when we begin using \u003ca href=\"https://visionmedia.github.io/page.js/\"\u003ePageJS\u003c/a\u003e. Like every other routing library, it allows us to be notified when the URL changes, it can force URL changes and it also allows to handle redirects.\u003c/p\u003e\n\u003cp\u003eTake a moment to install the library in our project:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ npm install page --save\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe will create our own library module on top of \u003cem\u003ePageJS\u003c/em\u003e which will be initialized from our \u003cem\u003eApp\u003c/em\u003e instance, getting passed the routing configuration, so it knows which function is has to invoke for every registerd route.\u003c/p\u003e\n\u003cp\u003eLet's begin by defining routing configuration module:\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/config/routes.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-language-javascript\"\u003e'use strict';\n\nimport router from '../plugins/router';\nimport HomePage from '../components/home-page';\nimport UserPage from '../components/user-page';\n\nvar routes = new Map();\n\nroutes.set('/', (context, next) =\u0026gt; {\n\t\tnext(null, HomePage);\n});\n\nroutes.set('/user/:username', (context, next) =\u0026gt; {\n\t\tnext(null, UserPage);\n});\n\nexport default routes;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow, the router module:\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/plugins/router.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-language-javascript\"\u003eimport page from 'page';\nimport Ractive from 'ractive';\n\nfunction navigationHandler(routeHandler, onNavigation) {\n\t\treturn function(context/*, next*/) {\n\t\t\trouteHandler(context, (error, PageComponent = {}, data = {}) =\u0026gt; {\n\t\t\t\tcontext.pageName = PageComponent._name;\n\t\t\tcontext.state = data;\n\t\t\tonNavigation(error, context);\n\t\t})\n\t};\n}\n\nexport function init(routes, onNavigation) {\n\t\n\troutes.forEach((routeHandler, path) =\u0026gt; {\n\t\t\tpage(path, navigationHandler(routeHandler, onNavigation));\n\t});\n\n\tpage({\n\t\t\thashbang: true\n\t});\n}\n\nexport function navTo(url) {\n\t\tpage.show(url);\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe \u003cem\u003einit\u003c/em\u003e function gets the configuration map and a callback as parameters. The second one will be invoked after the router handler gets executed with a \u003cem\u003econtext\u003c/em\u003e object containing routing information and the data passed from the route handler function (defined in the \u003cem\u003eroutes.js\u003c/em\u003e filed).\nThe last line in this file initializes \u003cem\u003ePageJS\u003c/em\u003e so, by default, it intercepts all links and checks if we have a handler configured for them.\nWe also pass the configuration \u003cem\u003ehashbang: true\u003c/em\u003e so we don't use HTML5 \u003cem\u003epushState\u003c/em\u003e and use the URL hash fragment instead, as we won't be using a server and the application would fail if we try to load an URL like this: http://localhost:8080/user/paquitosoft.\u003c/p\u003e\n\u003cp\u003eThis file also has a \u003cem\u003enavTo\u003c/em\u003e function so we can programatically navigate to any route. We will use it from our \u003cem\u003eSearchUser\u003c/em\u003e component.\u003c/p\u003e\n\u003cp\u003eOk, lets update our \u003cem\u003eApp\u003c/em\u003e instance to deal with routing with all we have done until now:\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/js/app.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-language-javascript\"\u003eimport Ractive from 'ractive';\nimport template from '../views/app.html';\n\nimport * as RouterPlugin from './plugins/router';\nimport routesConfiguration from './config/routes';\n\nimport RouterComponent from './components/layout/router';\nimport SearchUserComponent from './components/layout/search-user';\nimport HomePageComponent from './components/home-page';\nimport UserPageComponent from './components/user-page'\n\nlet App = new Ractive({\n\t\tel: '#app',\n\ttemplate: template,\n\tcomponents: {\n\t\t\tSearchUser: SearchUserComponent,\n\t\tRouter: RouterComponent,\n\t\tHomePage: HomePageComponent,\n\t\tUserPage: UserPageComponent\n\t},\n\tdata: {\n\t\t\tcomponentName: 'HomePage'\n\t},\n\toninit() {\n\t\t\tRouterPlugin.init(routesConfiguration, this.onNavigation.bind(this));\n\t\tconsole.log('App::oninit# Application initialized!');\n\t},\n\tonNavigation(error, navigationContext) {\n\t\t\tconsole.log('APP::onNavigation# Navigating to:', navigationContext.pageName, 'with context:', navigationContext);\n\n\t\tif (error) {\n\t\t\t\tconsole.warn('App::onNavigation# Error navigating:', error);\n\t\t} else {\n\t\t\t\tthis.set({\n\t\t\t\t\treq: {\n\t\t\t\t\t\tparams: navigationContext.params,\n\t\t\t\t\tbody: navigationContext.state\n\t\t\t\t},\n\t\t\t\tcomponentName: navigationContext.pageName\n\t\t\t});\n\t\t}\n\t}\n});\n\nexport default App;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow, when the \u003cem\u003eApp\u003c/em\u003e is initialized, it configures the route module passing the routes configuration and a callback function.\nWhen the callback gets called, we update the data context setting the \u003cem\u003ecomponentName\u003c/em\u003e attribute to the name of the page component we need to show. The value gets to this function in the \u003cem\u003enavigationContext\u003c/em\u003e parameter which gets passed from the router plugin, which gets it from the routes configuration the \u003cem\u003eApp\u003c/em\u003e passed upon initialization.\u003c/p\u003e\n\u003cp\u003eThe last touch is to update the home page so we can test our navigation:\n\u003cstrong\u003e\u003cem\u003eroot-folder\u003c/em\u003e/app/views/app.html\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026lt;h2 class=\u0026quot;text-center\u0026quot;\u0026gt;\n\tSearch by Github username above\n\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\n\tNav to \u0026lt;a href=\u0026quot;/user/paquitosoft\u0026quot;\u0026gt;User Page\u0026lt;/a\u0026gt;\n\u0026lt;/p\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow, if you load the home page on your browser (http://localhost:8080/), you should see this:\n\u003cimg src=\"/content/images/2015/08/ractive-tutorial-07.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eYou can follow the lower-left link to load the user page and use the upper-left (\u003cem\u003eNotetaker\u003c/em\u003e) title link to get back to the home page.\n(_Remember to remove the lower-left link once you're done with your tests).\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eYou can check the source code in \u003ca href=\"https://github.com/PaquitoSoft/notetaker-ractive\"\u003ethis GitHub repo\u003c/a\u003e.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003ePrevious post: \u003ca href=\"/post/ractive-js-tutorial-creating-the-barebones\"\u003eCreating the barebones\u003c/a\u003e\nNext post: \u003ca href=\"/post/ractive-js-tutorial-loading-user-info\"\u003eLoading user info\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n"},"_superjson":{"values":{"post.creationDate":["Date"]}}},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"ractive-js-tutorial-routing"},"buildId":"qDqkLNkeIvmmotP5mIhnk","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>